<!DOCTYPE html>
<html class="no-js">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1" charset="UTF-8">
    <title>Azure AI Vision Face UI SDK for Android</title>
    <link href="images/logo-icon.svg" rel="icon" type="image/svg">
    <script>var pathToRoot = "";</script>
    <script>document.documentElement.classList.replace("no-js","js");</script>
    <script>const storage = localStorage.getItem("dokka-dark-mode")
    if (storage == null) {
        const osDarkSchemePreferred = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
        if (osDarkSchemePreferred === true) {
            document.getElementsByTagName("html")[0].classList.add("theme-dark")
        }
    } else {
        const savedDarkMode = JSON.parse(storage)
        if(savedDarkMode === true) {
            document.getElementsByTagName("html")[0].classList.add("theme-dark")
        }
    }
    </script>
<script type="text/javascript" src="https://unpkg.com/kotlin-playground@1/dist/playground.min.js" async="async"></script>
<script type="text/javascript" src="scripts/sourceset_dependencies.js" async="async"></script>
<link href="styles/style.css" rel="Stylesheet">
<link href="styles/main.css" rel="Stylesheet">
<link href="styles/prism.css" rel="Stylesheet">
<link href="styles/logo-styles.css" rel="Stylesheet">
<link href="styles/font-jb-sans-auto.css" rel="Stylesheet">
<script type="text/javascript" src="scripts/clipboard.js" async="async"></script>
<script type="text/javascript" src="scripts/navigation-loader.js" async="async"></script>
<script type="text/javascript" src="scripts/platform-content-handler.js" async="async"></script>
<script type="text/javascript" src="scripts/main.js" defer="defer"></script>
<script type="text/javascript" src="scripts/prism.js" async="async"></script>
<script type="text/javascript" src="scripts/symbol-parameters-wrapper_deferred.js" defer="defer"></script>
</head>
<body>
    <div class="root">
<nav class="navigation" id="navigation-wrapper">
    <div class="navigation--inner">
        <div class="navigation-title">
            <button class="menu-toggle" id="menu-toggle" type="button">toggle menu</button>
            <div class="library-name">
                    <a class="library-name--link" href="index.html">
                            Azure AI Vision Face UI SDK for Android
                    </a>
            </div>
            <div class="library-version">
1.4.1            </div>
        </div>
        <div class="filter-section" id="filter-section">
                <button class="platform-tag platform-selector jvm-like" data-active="" data-filter=":azure-ai-vision-face-ui:dokkaHtml/release">androidJvm</button>
        </div>
    </div>
    <div class="navigation-controls">
        <button class="navigation-controls--btn navigation-controls--theme" id="theme-toggle-button" type="button">switch theme</button>
        <div class="navigation-controls--btn navigation-controls--search" id="searchBar" role="button">search in API</div>
    </div>
</nav>
        <div id="container">
            <div class="sidebar" id="leftColumn">
                <div class="sidebar--inner" id="sideMenu"></div>
            </div>
            <div id="main">
<div class="main-content" id="content" pageIds="Azure AI Vision Face UI SDK for Android::////PointingToDeclaration//1717806726">
  <div class="breadcrumbs"></div>
  <div class="cover ">
    <h1 class="cover"><span><span>Azure</span></span> <span><span>AI</span></span> <span><span>Vision</span></span> <span><span>Face</span></span> <span><span>UI</span></span> <span><span>SDK</span></span> <span><span>for</span></span> <span><span>Android</span></span></h1>
    <div class="platform-hinted UnderCoverText" data-platform-hinted="data-platform-hinted"><div class="content sourceset-dependent-content" data-active="" data-togglable=":azure-ai-vision-face-ui:dokkaHtml/release"><p class="paragraph">The Azure AI Vision Face UI SDK for Android allows you to build Android applications to perform face liveness checks.</p><h2 class="">Prerequisites</h2><ul><li><p class="paragraph">An Azure Face API resource subscription.</p></li><li><p class="paragraph">A PC (Windows, Linux, Mac) with Android Studio installed.</p></li><li><p class="paragraph">An Android mobile device (API level 24 or higher).</p></li></ul><h2 class="">Step 1: Set up the environment</h2><h3 class="">Step 1.1 Get Access Token to SDK Artifact</h3><p class="paragraph">The access token is used for maven authentication. Get the access token to access the release artifacts using the API: <a href="https://learn.microsoft.com/rest/api/face/liveness-session-operations/get-client-assets-access-token?view=rest-face-v1.3-preview">Liveness Session Operations - Get Client Assets Access Token</a>. The solution uses azure maven repo artifact to add the binary enabling the liveness feature.  You will need to set up azure maven repo with any username and valid &quot;access token&quot; as &quot;password&quot;.  This token will be used as <code class="lang-kotlin">mavenPassword</code> in the Add Build Dependency section below.</p><h3 class="">Step 1.2 Add Credential</h3><p class="paragraph"><img alt="Add Credential" src="https://raw.githubusercontent.com/Azure-Samples/azure-ai-vision-sdk/refs/heads/main/samples/kotlin/face/FaceLivenessDetectorSample/README-resources/maven_cred.png"> You need to add credentials in <code class="lang-kotlin">gradle.properties</code> to set up variable <code class="lang-kotlin">mavenUser</code> and <code class="lang-kotlin">mavenPassword</code> used above.  These are obtained through azure command in sdk access.  <code class="lang-kotlin">mavenPassword</code> is the access token from above section.<br>The credential is going to look like:</p><div class="sample-container"><pre><code class="block lang-properties" theme="idea">mavenUser=any_username_string<br>mavenPassword=access_token</code></pre><span class="top-right-position"><span class="copy-icon"></span><div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div></span></div><h2 class="">Step 2 Integrate face liveness detection into your own application</h2><h3 class="">Step 2.1 The overview of face recognition with liveness detection in Azure AI Vision SDK for Android</h3><p class="paragraph">Here is the outline of the SDK sample and integration structure</p><ol><li><p class="paragraph">The solution uses azure maven repo artifact to add the binary enabling the liveness feature.  You will need to set up azure <code class="lang-kotlin">maven</code> repo with any <code class="lang-kotlin">username</code> and valid &quot;access token&quot; as &quot;password.  It is be mentioned in <code class="lang-kotlin">Get Access Token to SDK Artifact</code> section for getting the password, along with the <code class="lang-kotlin">Add Build Dependencies</code> to set the repo in the solution files.</p></li><li><p class="paragraph">The app requires camera permission.  You will need to set it up in the app configuration and code.  It will be mentioned below in <code class="lang-kotlin">Add Camera Permission</code> and <code class="lang-kotlin">Add Kotlin code to Request Camera Permission</code> sections for demonstration.</p></li><li><p class="paragraph">There is an compose method called <code class="lang-kotlin">FaceLivenessDetector</code>.  The compose component consists a one stop bundle for the liveness feature with UI code.</p></li><li><p class="paragraph">The compose method takes a set of parameters launching it, the parameters defines the liveness session and callback behaviour.  It will be mentioned below in <code class="lang-kotlin">Add code to interpret the result</code> section to demostrate how to use it.</p></li></ol><h3 class="">Step 2.2 Add Camera Permissions</h3><p class="paragraph">Face UI SDK requires access to the camera to perform liveness detection. You need to prompt the user to grant camera permission.  Here is how to add camera permissions and activity data in the manifest: Add permission for the app in <code class="lang-kotlin">AndroidManifest.xml</code></p><div class="sample-container"><pre><code class="block lang-xml" theme="idea">    &lt;uses-permission android:name=&quot;android.permission.INTERNET&quot; /&gt;<br>    &lt;uses-permission android:name=&quot;android.permission.CAMERA&quot; /&gt;<br>    &lt;uses-permission android:name=&quot;android.permission.VIBRATE&quot; /&gt;<br>    &lt;uses-feature android:name=&quot;android.hardware.camera&quot; /&gt;<br>    &lt;uses-feature android:name=&quot;android.hardware.screen.portrait&quot; /&gt;</code></pre><span class="top-right-position"><span class="copy-icon"></span><div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div></span></div><p class="paragraph">and now add proper code to request camera permission in kotlin as below</p><h3 class="">Step 2.3 Add Kotlin code to Request Camera Permission</h3><p class="paragraph">You can look at <code class="lang-kotlin">MainActivity.kt</code> for sample on how to achieve the same or follow the guidelines for <a href="https://developer.android.com/training/permissions/requesting">Android</a>.  Camera permission needs to be ready before calling the liveness process. Here is part of the code piece that asks camera permission</p><div class="sample-container"><pre><code class="block lang-kotlin" theme="idea">    private fun requestPermissions() {<br>        if (ContextCompat.checkSelfPermission(applicationContext, android.Manifest.permission.CAMERA)<br>            != PackageManager.PERMISSION_GRANTED<br>        ) {<br>            ActivityCompat.requestPermissions(<br>                this,<br>                arrayOf(android.Manifest.permission.CAMERA),<br>                cAppRequestCode<br>            )<br>        }<br>    }</code></pre><span class="top-right-position"><span class="copy-icon"></span><div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div></span></div><h3 class="">Step 2.4 Add Build Dependency</h3><ul><li><p class="paragraph">You need to add the following dependencies to apps' build.grade.kts <code class="lang-kotlin">plugins</code> section.</p></li></ul><div class="sample-container"><pre><code class="block lang-kotlin" theme="idea">plugins {<br>    id(&quot;com.android.application&quot;)<br>    id(&quot;org.jetbrains.kotlin.android&quot;)<br>    id(&quot;org.jetbrains.kotlin.plugin.serialization&quot;)<br>}</code></pre><span class="top-right-position"><span class="copy-icon"></span><div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div></span></div><ul><li><p class="paragraph">You need to add the following dependencies to apps' build.grade.kts <code class="lang-kotlin">dependencies</code> section.</p></li></ul><div class="sample-container"><pre><code class="block lang-kotlin" theme="idea">    implementation(&quot;com.azure:azure-ai-vision-face-ui:+&quot;)<br>    implementation(&quot;com.azure.android:azure-core-http-httpurlconnection:1.0.0-beta.10&quot;)</code></pre><span class="top-right-position"><span class="copy-icon"></span><div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div></span></div><ul><li><p class="paragraph">You need to have mavenCentral in the repository.</p></li></ul><div class="sample-container"><pre><code class="block lang-kotlin" theme="idea">mavenCentral()</code></pre><span class="top-right-position"><span class="copy-icon"></span><div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div></span></div><ul><li><p class="paragraph">You need to add repository in the settings.gradle.kts for dependencyResolutionManagement</p></li></ul><div class="sample-container"><pre><code class="block lang-kotlin" theme="idea">                maven {<br>                    url = uri(&quot;https://pkgs.dev.azure.com/msface/SDK/_packaging/AzureAIVision/maven/v1&quot;)<br>                    credentials {<br>                        username = mavenUser<br>                        password = mavenPassword<br>                    }<br>                }</code></pre><span class="top-right-position"><span class="copy-icon"></span><div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div></span></div><ul><li><p class="paragraph">You need to add credentials in gradle.properties to set up variable <code class="lang-kotlin">mavenUser</code> and <code class="lang-kotlin">mavenPassword</code> used above. These are obtained through azure command from above <code class="lang-kotlin">Get Access Token to SDK Artifact</code> section.</p></li></ul><div class="sample-container"><pre><code class="block lang-properties" theme="idea">mavenUser=any_username_string<br>mavenPassword=access_token</code></pre><span class="top-right-position"><span class="copy-icon"></span><div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div></span></div><ul><li><p class="paragraph">If you use ProGuard or DexGuard, please refer to <code class="lang-kotlin">ProGuard Exceptions</code> and <code class="lang-kotlin">DexGuard Exceptions</code> for details.</p></li></ul><h3 class="">Step 2.5 Add code to interpret the result</h3><p class="paragraph">The activity takes a set of parameters launching it.  The parameter defines the activity callback behaviour.  The parameters for input are <code class="lang-kotlin">sessionAuthorizationToken</code>, <code class="lang-kotlin">verifyImageFileContent</code>, <code class="lang-kotlin">deviceCorrelationId</code>, <code class="lang-kotlin">userCorrelationId</code>.</p><ul><li><p class="paragraph">sessionAuthorizationToken: session authorization token from the server</p></li><li><p class="paragraph">verifyImageFileContent: when choosing livenessWithVerify and setting verify image in the client, this is the ByteArray of the file content of the image.  Otherwise it should be <code class="lang-kotlin">null</code>.</p></li><li><p class="paragraph">deviceCorrelationId: when choosing not to set deviceCorrelationId in the token creation time, you can put the deviceCorrelationId here.  Otherwise it should be <code class="lang-kotlin">null</code>.</p></li><li><p class="paragraph">userCorrelationId: when choosing not to set userCorrelationId in the token creation time, you can put the userCorrelationId here.  Otherwise it should be <code class="lang-kotlin">null</code>.</p></li></ul><p class="paragraph">The parameters for the callback are <code class="lang-kotlin">OnSuccess</code> and <code class="lang-kotlin">OnError</code> method.</p><ul><li><p class="paragraph">OnSuccess: Get called back when the session is completed successfully with <code class="lang-kotlin">LivenessDetectionSuccess</code>.  <code class="lang-kotlin">LivenessDetectionSuccess</code> shows the liveness session result.</p></li></ul><p class="paragraph">Inside  <code class="lang-kotlin">LivenessDetectionSuccess</code></p><ul><li><p class="paragraph">digest The validation string to be used to verify the communication for this call is secure.  For more information check section below <code class="lang-kotlin">Add validation for the integrity of the service result</code></p></li><li><p class="paragraph">ResultId The ID to be used to track the result submission process.</p></li><li><p class="paragraph">OnError: Get called back when the session is completed successfully with <code class="lang-kotlin">LivenessDetectionError</code>.  <code class="lang-kotlin">LivenessDetectionError</code> shows the liveness session error reasons.</p></li></ul><div class="sample-container"><pre><code class="block lang-kotlin" theme="idea">    fun onSuccess(livenessDetectionSuccess: LivenessDetectionSuccess) {<br>        <br>        <br>    }<br><br>    fun onError(livenessDetectionError: LivenessDetectionError) {<br>        <br>        <br>    }</code></pre><span class="top-right-position"><span class="copy-icon"></span><div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div></span></div><h3 class="">Step 2.6 Run liveness flow</h3><p class="paragraph">Add FaceLivenessDetector in the compose UI.</p><ul><li><p class="paragraph">&quot;endpoint&quot; is the url for the endpoint server address.</p></li><li><p class="paragraph">&quot;session authorization token&quot; should be obtained in App Server.  A demo version on obtaining the token is in <code class="lang-kotlin">MainScreenViewModel.kt</code> for the demo app to be built as an standalone solution, but this is not recommended.  The session-authorization-token is required to start a liveness session.  For more information on how to orchestrate the liveness flow by utilizing the Azure AI Vision Face service, visit: <a href="https://aka.ms/azure-ai-vision-face-liveness-tutorial">https://aka.ms/azure-ai-vision-face-liveness-tutorial</a>.</p></li></ul><p class="paragraph">Then the compose component can be called with the code:</p><div class="sample-container"><pre><code class="block lang-kotlin" theme="idea">FaceLivenessDetector(<br>            sessionAuthorizationToken = FaceSessionToken.sessionToken,<br>            verifyImageFileContent = FaceSessionToken.sessionSetInClientVerifyImage,<br>            deviceCorrelationId = null,<br>            userCorrelationId = null,<br>            onSuccess = viewModel::onSuccess,<br>            onError = viewModel::onError<br>        )</code></pre><span class="top-right-position"><span class="copy-icon"></span><div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div></span></div><p class="paragraph">Please note that the detection result isn't present in the client code.  You can retrieve it when calling the <code class="lang-kotlin">detectLiveness-sessions/&lt;session-id&gt;</code> REST call. You can check <a href="https://learn.microsoft.com/rest/api/face/liveness-session-operations/get-liveness-session-result?view=rest-face-v1.2&amp;tabs=HTTP">API Reference</a></p><h3 class="">Step 2.7 Add validation for the integrity of the service result</h3><p class="paragraph">We highly recommend leveraging the &quot;digest&quot; generated within the solution to validate the integrity of the communication between your application and the Azure AI Vision Face service. This is necessary to ensure that the final liveness detection result is trustworthy. &quot;Digest&quot; is provided in the following two locations:</p><ol><li><p class="paragraph">&quot;digest&quot; property in LivenessDetectionSuccess shown in <code class="lang-kotlin">Step 5 Add code to interpret the result</code></p></li><li><p class="paragraph">The Azure AI Vision Face service.</p><p class="paragraph">The &quot;digest&quot; will be contained within the liveness detection result when calling the <code class="lang-kotlin">detectLiveness-sessions/&lt;session-id&gt;</code> REST call. Look for an example of the &quot;digest&quot; in the <a href="https://aka.ms/azure-ai-vision-face-liveness-tutorial">tutorial</a> where the liveness detection result is shown.</p><p class="paragraph">Digests must match between the application and the service. We recommend using these digests in conjunction with platform integrity APIs to perform the final validation.    For more information on the Integrity APIs, please refer to:</p></li><ul><li><p class="paragraph"><a href="https://developer.android.com/google/play/integrity/overview">Overview of the Play Integrity API</a></p></li></ul></ol><h3 class="">Step 2.8 Configure Build Tools</h3><h4 class="">Step 2.8.1 ProGuard Exceptions</h4><p class="paragraph">If you plan to minify your application, you need to add following exceptions to your application's proguard-rules.pro file.</p><div class="sample-container"><pre><code class="block lang-pro" theme="idea">-dontwarn org.slf4j.impl.StaticLoggerBinder<br>-dontwarn org.slf4j.impl.StaticMDCBinder<br>-dontwarn org.slf4j.impl.StaticMarkerBinder</code></pre><span class="top-right-position"><span class="copy-icon"></span><div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div></span></div><p class="paragraph">Alternatively, follow the instructions in the build error message to copy the rules from &quot;missing_rules.txt&quot; file located in your app's <code class="lang-kotlin">build\outputs\mapping\{releaseVariant}</code> folder to address these build errors.</p><h4 class="">Step 2.8.2 DexGuard Exceptions</h4><p class="paragraph">If your application integrates with Dexguard using Gradle plugin, you don't have to do anything special. All the Face UI SDK consumer rules will be automatically picked up by DexGuard.<br>If your application is processed by Dexguard command line tool, make sure you include necassary keep rules for Face UI SDK by:</p><ol><li><p class="paragraph">Locate the Face UI SDK aar</p></li><li><p class="paragraph">Extract the <code class="lang-kotlin">proguard.txt</code> from the Face UI SDK aar. For details about AAR, refer to <a href="https://developer.android.com/studio/projects/android-library#aar-contents">Anatomy of an AAR file</a>.</p></li><li><p class="paragraph">Include the Face UI SDK consumer rules by adding the following line in your DexGuard configuration file. Make sure to replace <code class="lang-kotlin">&lt;Path to extracted proguard.txt&gt;</code> with the actual file path.</p><div class="sample-container"><pre><code class="block lang-pro" theme="idea"> -include &lt;Path to extracted proguard.txt&gt;</code></pre><span class="top-right-position"><span class="copy-icon"></span><div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div></span></div></li></ol><h2 class="">FAQ</h2><h3 class="">Q: How can I get the results of the liveness session?</h3><p class="paragraph">Once the session is completed, for security reasons the client does not receive the outcome whether face is live or spoof.</p><p class="paragraph">You can query the result from your backend service by calling the sessions results API to get the outcome <a href="https://aka.ms/face/liveness-session/get-liveness-session-result">https://aka.ms/face/liveness-session/get-liveness-session-result</a></p><h3 class="">Q: How do I provide localization?</h3><p class="paragraph">The SDK provides default localization for 75 locales.  They should work automatically.  It is provided through <code class="lang-kotlin">values-</code> folder in the resources in aar. For more information, <a href="https://developer.android.com/guide/topics/resources/localization">Localize your app</a>.</p><h3 class="">Q: How do I override localization and customize the display strings?</h3><p class="paragraph">Please refer to the localization FAQ answer above. See <a href="https://github.com/Azure-Samples/azure-ai-vision-sdk/blob/main/samples/Localization.md">Localization</a>.</p></div></div>
  </div>
  <h2 class="">Packages</h2>
  <div class="table"><a data-name="-1666426404%2FPackages%2F1717806726" anchor-label="com.azure.android.ai.vision.face.ui" id="-1666426404%2FPackages%2F1717806726" data-filterable-set=":azure-ai-vision-face-ui:dokkaHtml/release"></a>
    <div class="table-row" data-filterable-current=":azure-ai-vision-face-ui:dokkaHtml/release" data-filterable-set=":azure-ai-vision-face-ui:dokkaHtml/release">
      <div>
        <div class="main-subrow ">
          <div class=""><span class="inline-flex">
              <div><a href="-azure -a-i -vision -face -u-i -s-d-k for -android/com.azure.android.ai.vision.face.ui/index.html">com.azure.android.ai.vision.face.ui</a></div>
<span class="anchor-wrapper"><span class="anchor-icon" pointing-to="-1666426404%2FPackages%2F1717806726"></span>
                <div class="copy-popup-wrapper "><span class="copy-popup-icon"></span><span>Link copied to clipboard</span></div>
              </span></span></div>
          <div class="pull-right">
            <div class="platform-tags no-gutters">
              <div class="platform-tag jvm-like">androidJvm</div>
            </div>
          </div>
        </div>
        <div></div>
      </div>
    </div>
  </div>
</div>
      <div class="footer">
        <span class="go-to-top-icon"><a href="#content" id="go-to-top-link"></a></span><span>© 2025 Copyright</span><span
                class="pull-right"><span>Generated by </span><a
                href="https://github.com/Kotlin/dokka"><span>dokka</span><span class="padded-icon"></span></a></span>
      </div>
            </div>
        </div>
    </div>
</body>
</html>
